const ChaningCanvas=((a,b,c)=>{function d(a){return a in q}function e(a){return+a||0}function f(a,b,d){return a.concat(c(b).fill()).slice(0,b).map(d||e)}function g(a){return"string"==typeof a||a instanceof CanvasGradient}function h(b){return b&&s.some(c=>b instanceof a[c])}function j(a){return null!=a&&(c.isArray(a)||"number"==typeof a.length&&-1<a.length)}function k(a){return a+(["st","nd"][a%10-1]||"th")}function l(b){return b instanceof a.HTMLElement}function m(a,b,c){return`${a} parameter ${b} is not of type '${c}'.`}function n(a,b){const c=a.ctx;return a.path.forEach((d,e)=>{const f=d.type;for(let a=0;a<u.length;a++){const b=u[a][0];if(f===b&&c[f])return c[f](...d.params)}switch(f){case"point":c[`${e?"line":"move"}To`](...d.params);break;default:throw a.path.length=0,new TypeError(`${b} ${k(i)} element of path data is Unkwon path type.`);}}),a}const o=Math.PI,p=b.createElement("canvas"),q=p.getContext("2d"),r="Failed to execute",s=["Image","CSSImageValue","HTMLImageElement","SVGImageElement","HTMLVideoElement","HTMLCanvasElement","ImageBitmap","OffscreenCanvas"],t={},u=[["moveTo",2],["point",2],["arc",6],["bezierCurveTo",6],["quadraticCurveTo",4],["ellipse",8]];return u.forEach(([a,b])=>{t[a]=function(...c){return{type:a,params:f(c,b)}}}),t.lineTo=t.point,t.circle=function(a,b,c){return[a,b,c]=[a,b,c].map(e),[t.moveTo(a+c,b),t.arc(a,b,c,0,2*o)]},t.deg=function(a){return 180*a/o},class a{constructor(a){this.element=a,this.ctx=a.getContext("2d"),this.path=[]}static create(c){const d=b.createElement("canvas");return c={width:300,height:300,...Object(c)},Object.assign(d,c),new a(d)}static prepareStyle(a){for(let b in a)d(b)||console.warn(`Can't find ${b} is valid style key.`);return a}appendInto(a){if(!l(a))throw new TypeError(m(`${r} 'appendInto':`,1,"HTMLElement"));return a.appendChild(this.element),this}toImg(...a){return this.toImage(...a)}toImage(a,b){const c=this.element,d=new Image,e=new Promise((b,e)=>{d.src=c.toDataURL(a||"image/png"),d.onload=()=>b(d),d.onerror=e});return"function"==typeof b?(e.then(a=>b(a,null)).catch(a=>b(null,a)),this):e}getImgData(...a){return this.getImageData(...a)}getImageData(a,b,c,d){const f=[a,b,c,d].map(e);return this.ctx.getImageData(...f).data}getPixelData(...a){return this.getPixel(...a)}getPixel(c,d){const[f,h,g,b]=this.ctx.getImageData(...[c,d].map(e),1,1).data;return{r:f,g:h,b:g,a:b}}set(a){return a={...Object(a)},["lineDash","transform"].forEach(b=>{b in a&&(this[b]=a[b],delete a[b])}),Object.assign(this.ctx,a),this}set lineDash(a){return this.ctx.setLineDash(a)}get lineDash(){return this.ctx.getLineDash()}set transform(a){return this.ctx.setTransform(...(j(a)?c.from(a):[a]))}get transform(){return this.ctx.getTransform()}execute(a,b){const c=this.ctx;return c.save(),this.set(a),b(this),c.restore(),this}drawImg(...a){return this.drawImage(...a)}drawImage(a,b,c,...d){if(!h(a)){const a=s.join(" or ");throw new TypeError(m(`${r} 'drawImage':`,1,a))}return b=+b||0,c=+c||0,this.ctx.drawImage(a,b,c,...d),this}clear(a,b){const c=this.element;return a=a||c.width,b=b||c.height,this.ctx.clearRect(0,0,a,b),this}resetPath(...a){return this.closePath(...a)}closePath(){return this.ctx.closePath(),this.path.length=0,this}addPath(a){const b=this.ctx,d=`${r} 'addPath':`;let e;if("function"!=typeof a)throw new TypeError(m(d,1,"Function"));if(e=a(t),!j(e))throw new TypeError(`${d} callback function must return value, which is type of Array.`);return e=c.from(e).flat(1/0),e.forEach((a,b)=>{if(!a||!a.type)throw new TypeError(`${d} ${k(b)} element of path data is Unkwon path type.`)}),this.path.push(...e),this}setPath(a){return this.closePath().addPath(a)}fill(a,b,c,d,e){const f=this.element,h=this.ctx;return(a=g(a)?{fillStyle:a}:{},[0,1].includes(arguments.length)&&this.path.length)?n(this,`${r} 'fill':`).execute(a,()=>h.fill()):(b=b||0,c=c||0,d=null==d?f.width:d,e=null==e?f.height:e,this.execute(a,()=>h.fillRect(b,c,d,e)))}stroke(a){return n(this,`${r} 'stroke':`).execute(a,a=>a.ctx.stroke())}}})(this,document,Array);
